<%- include ("./partials/header") %>	

	<div class = "header">
		
			<h2><i>WELCOME TO</i><br>
		
		
			<strong>ANJAM</strong>
		</h2>
			<p class='tag-line'>Premium African Music</p>			

			<article>
				<form action = "/songs/1" method="GET" class = "form-inline">
					<div class = "form-group">
						<input type = "text" name = "search" placeholder = "Search..." class = "form-control" required>
						<input type = "submit" value = "Search" class = "btn btn-default">
						<button type="button" class="btn btn-outline-dark btn-sm" data-toggle="modal" data-target="#myModal">
  <span class="badge">Search Suggestions</span>
</button>
					</div>
				</form>
				
			</article>			
	</div> 
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		  <h4 class="modal-title" id="myModalLabel">Suggested Tags</h4> <% console.log(typeof isAdmin);	if(typeof isAdmin !== 'undefined' && isAdmin === true){%><a href = "/tags/edit" class = "btn btn-primary btn-xs">Edit Tags</a><%}%>
      </div>
      <div class="modal-body">
		  <div id = "suggestedTags" class = "flex-container">  
			  
		  
		  <%
		  	tags.forEach(function(tag){%>
				<div  class = 'label label-default lb-md tag' onClick=addTag('<%=tag.tag%>')><%=tag.tag%></div>
			<%})%>
		 
		  
		  </div>
		  <br><br>
		   <h4 class="modal-title" id="myModalLabel">Selected Tags</h4>
		  <div id = "selectedTags" class="flex-container">
			  
		  </div>
      </div>
      <div id = "modal-footer" class="modal-footer">
        <!--<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>-->
        
      </div>
    </div>
  </div>
</div>

<script type = "text/javascript">
	
	const addedTags = [];	
	
	//let link = document.createTextNode("Search");
	//a.appendChild(link);
	
	//a.href = "/songs/1?search=";
	
	
	const addTag = (tag)=>{
		
		
		
		if(addedTags.includes(tag)){
			
			const index = addedTags.indexOf(tag);
			if(index > -1){
				addedTags.splice(index, 1);
			}
			
		}else{
			
			addedTags.push(tag);
			
		}
		
		const cleanArr = tagsToHtml(addedTags);
		
		cleanArr.sort();
		
		let arrToStr = cleanArr.toString().replace(/,/g,'');
		
		document.getElementById('selectedTags').innerHTML = arrToStr;		
		if(cleanArr.length > 0)
			{
				document.getElementById('modal-footer').appendChild(searchButton);		
			}else
			{
				document.getElementById('modal-footer').removeChild(searchButton);
			}
	}
	
	const tagsToHtml = (selTags) =>
	{
		
		const cleanArr = [];
		selTags.forEach(function(tag)
		{
			tag = "<div class = 'label label-default lb-md'>"+ tag +"</div> "
						cleanArr.push(tag);
		})
	
		return cleanArr;
		
	}
	
	
	
	const createSearchString = () =>{		
		
		
		let searchString = addedTags.map((tags) =>(
		
		tags+"+"
		
		))
		
		searchString = searchString.toString();
		searchString=searchString.replace(/,/g , "");
		searchString=searchString.slice(0,-1)
		
		const url = "/songs/1?search="+searchString;
		
		 window.location.assign("/songs/1?search="+searchString)
		
		//alert(url);
		
	}
	
	let searchButton = document.createElement('button');
	searchButton.title = "Search tags";
	searchButton.innerHTML = "Search tags";
	searchButton.className = "btn btn-default";
	searchButton.type = "button";
	searchButton.onclick = function(){ createSearchString()};
	

</script>
    

<%- include ("./partials/footer") %>